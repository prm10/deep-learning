clc;clear all;close all;
n=2;
data_train0=rand(2^n);
data_train1=repmat(data_train0,10000,1);
x=generate_batches(data_train1,100);
%% sparse
% [~,w1,w2,b1,b2]=sparse_autocoder(x,n,200);
% [dataout,a2]=sparse_autocoder_reconstruction(data_train0,w1,w2,b1,b2);

%% dnn
layer=[10 5 2];
[w1,w2,b1,b2]=dnn_train(x,layer,100);
[data_out,median_out]=dnn_test(data_train0,w1,w2,b1,b2);
%% result visualize
imshow([data_train0 dataout]);
info=length(unique((a2>.5)*2.^(n-1:-1:0)'));
% figure;
% visualize(w1)
